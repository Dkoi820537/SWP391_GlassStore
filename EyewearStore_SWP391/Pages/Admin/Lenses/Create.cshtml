@page
@model EyewearStore_SWP391.Pages.Admin.Lenses.CreateModel
@{
    ViewData["Title"] = "Add New Lens";
    Layout = "_Layout";
}

<link rel="stylesheet" href="~/css/lenses-admin.css" asp-append-version="true" />

<div class="admin-container">
    <!-- Breadcrumb -->
    <nav class="admin-breadcrumb" aria-label="breadcrumb">
        <a href="/">Home</a>
        <span class="separator">â€º</span>
        <a href="/Admin">Admin</a>
        <span class="separator">â€º</span>
        <a href="/Admin/Lenses">Lenses</a>
        <span class="separator">â€º</span>
        <span>Add New</span>
    </nav>

    <!-- Header -->
    <div class="admin-header">
        <h1>Add New Lens</h1>
    </div>

    <!-- Form -->
    <form id="lensForm" class="admin-form" novalidate>
        <input type="hidden" name="productId" value="">

        <!-- Basic Information -->
        <div class="form-section">
            <h2 class="form-section-title">Basic Information</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="sku">SKU <span style="color: var(--error);">*</span></label>
                    <input type="text" 
                           id="sku" 
                           name="sku" 
                           maxlength="50"
                           required 
                           aria-required="true"
                           placeholder="e.g., LENS-SV-001">
                    <span class="error-message">SKU is required</span>
                </div>

                <div class="form-group">
                    <label for="name">Name <span style="color: var(--error);">*</span></label>
                    <input type="text" 
                           id="name" 
                           name="name" 
                           maxlength="255"
                           required 
                           aria-required="true"
                           placeholder="e.g., Single Vision Clear Lens">
                    <span class="error-message">Name is required</span>
                </div>
            </div>

            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" 
                          name="description" 
                          rows="3"
                          placeholder="Enter lens description..."></textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="lensType">Lens Type</label>
                    <select id="lensType" name="lensType">
                        <option value="">Select lens type</option>
                        <option value="Single Vision">Single Vision</option>
                        <option value="Bifocal">Bifocal</option>
                        <option value="Progressive">Progressive</option>
                        <option value="Reading">Reading</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="lensIndex">Lens Index</label>
                    <input type="number" 
                           id="lensIndex" 
                           name="lensIndex" 
                           step="0.01" 
                           min="1.0" 
                           max="2.0" 
                           placeholder="e.g., 1.50, 1.60, 1.67"
                           aria-describedby="lensIndexHelp">
                    <small id="lensIndexHelp" style="color: var(--secondary-warm-gray);">
                        Refractive index between 1.0 and 2.0
                    </small>
                    <span class="error-message">Lens index must be between 1.0 and 2.0</span>
                </div>
            </div>

            <div class="form-group">
                <label for="isPrescription">Prescription Required</label>
                <select id="isPrescription" name="isPrescription">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                </select>
            </div>
        </div>

        <!-- Pricing & Stock -->
        <div class="form-section">
            <h2 class="form-section-title">Pricing & Inventory</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="price">Price <span style="color: var(--error);">*</span></label>
                    <input type="number" 
                           id="price" 
                           name="price" 
                           step="0.01" 
                           min="0.01" 
                           required
                           placeholder="0.00"
                           aria-required="true">
                    <span class="error-message">Price must be greater than 0</span>
                </div>

                <div class="form-group">
                    <label for="currency">Currency</label>
                    <select id="currency" name="currency">
                        <option value="VND" selected>VND</option>
                        <option value="USD">USD</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="inventoryQty">Inventory Quantity</label>
                    <input type="number" 
                           id="inventoryQty" 
                           name="inventoryQty" 
                           min="0" 
                           placeholder="Optional">
                </div>

                <div class="form-group">
                    <label for="isActive">Status</label>
                    <select id="isActive" name="isActive">
                        <option value="true" selected>Active</option>
                        <option value="false">Inactive</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Images -->
        <div class="form-section">
            <h2 class="form-section-title">Images</h2>
            
            <div id="imageUploadZone" class="image-upload-zone" role="button" tabindex="0" aria-label="Upload images">
                <div class="upload-icon">ðŸ“·</div>
                <p class="upload-text">Drag and drop images here, or click to select</p>
                <p class="upload-hint">Supported formats: JPG, PNG, WebP. Max size: 5MB</p>
            </div>
            <input type="file" 
                   id="imageInput" 
                   accept=".jpg,.jpeg,.png,.webp" 
                   multiple 
                   hidden
                   aria-hidden="true">
            
            <div id="imagePreviewGrid" class="image-preview-grid"></div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
            <a href="/Admin/Lenses" class="btn btn-secondary">Cancel</a>
            <button type="submit" class="btn btn-primary">Save Lens</button>
        </div>
    </form>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-spinner"></div>
</div>

<!-- Toast Container -->
<div id="toastContainer" class="toast-container"></div>

@section Scripts {
    <script src="~/js/lenses-admin.js" asp-append-version="true"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            LensAdmin.init({ page: 'create' });
        });
    </script>
}
